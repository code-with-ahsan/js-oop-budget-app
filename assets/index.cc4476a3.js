var E=Object.defineProperty;var w=(o,t,e)=>t in o?E(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var n=(o,t,e)=>(w(o,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=e(a);fetch(a.href,i)}})();class _{constructor(){n(this,"localStorageKey")}getAll(){return JSON.parse(localStorage.getItem(this.localStorageKey)||"[]")}setAll(t=[]){localStorage.setItem(this.localStorageKey,JSON.stringify(t))}updateOne(){}deleteOne(){}deleteAll(){localStorage.removeItem(this.localStorageKey)}}class b extends _{constructor(){super(...arguments);n(this,"localStorageKey","budget_app_transactions")}}class v extends _{constructor(){super(...arguments);n(this,"localStorageKey","budget_app_wallets")}}const S=(o,t,e,s,a)=>{const[i,r,d,l,m]=o;return`${i}${t}${r}${e}${d}${s}${l}${a}${m}`};class u{constructor({title:t,amount:e,isPrimary:s}){n(this,"title");n(this,"amount");n(this,"id");n(this,"isPrimary");this.title=t,this.amount=e,this.id=self.crypto.randomUUID(),this.isPrimary=s||!1}update({amount:t,isPrimary:e}){t!==void 0&&(this.amount+=t),this.isPrimary=e!==void 0?e:this.isPrimary}setIsPrimary(t){this.isPrimary=t}getHtml(){return S`
      <li id="${this.id}" class="sidebar__wallets__list__item p-4 rounded-lg flex flex-col gap-2 ${this.isPrimary?"sidebar__wallets__list__item--active":""}">
        <h4 class="sidebar__wallets__list__item__heading font-bold">${this.title}</h4>
        <p class="sidebar__wallets__list__item__amount text-slate-500">$${this.amount}</p>
      </li>
    `}}class T{constructor(){n(this,"wallet");n(this,"wallets",[]);n(this,"transactionStorage",new b);n(this,"walletStorage",new v);n(this,"transactions",[]);n(this,"categories",[{title:"Restaurants & Cafe",iconClasses:"fa-solid fa-utensils",value:"restaurants-and-cafe"},{title:"Clothes & Shopping",iconClasses:"fa-solid fa-shirt",value:"clothes-and-shopping"},{title:"Credits & Loans",iconClasses:"fa-solid fa-credit-card",value:"credits-and-loans"},{title:"Gift Cards",iconClasses:"fa-solid fa-gift",value:"gift-cards"}]);let t=this.walletStorage.getAll();if(!t.length)t=[new u({title:"Google Pay",amount:5e3}),new u({title:"Apple Pay",amount:2e3})],this.setPrimaryWallet(t[0]);else{t=t.map(s=>new u(s));const e=t.find(s=>s.isPrimary);this.wallet=e}this.wallets=t}setPrimaryWallet(t){this.wallet&&this.wallet.setIsPrimary(!1),t.setIsPrimary(!0),this.wallet=t}}function p(o){var t=document.createElement("div");return t.innerHTML=o.trim(),t.firstElementChild}const $=(o,t,e,s,a,i,r)=>{const[d,l,m,h,g,f,y]=o;return`${d}${t}${l}${e}${m}${s}${h}${a}${g}${i}${f}${r}${y}`};class C{constructor({category:t,title:e,date:s,amount:a,type:i}){n(this,"category");n(this,"title");n(this,"date");n(this,"amount");n(this,"type");this.category=t||null,this.id=self.crypto.randomUUID(),this.title=e,this.date=(s||new Date).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),this.type=i,this.amount=Number(a)}update({category:t,title:e,type:s,amount:a}){this.category=t||this.category,this.type=s||this.type,this.amount=a||this.amount,this.title=e||this.title}getHtml(){var t;return $`
    <div id="transaction_${this.id}" class="main-section__transactions__item mb-4 duration-300 hover:shadow-lg shadow-sm bg-white rounded-lg p-4 flex items-center gap-4 text-xs sm:text-base">
      <div class="main-section__transactions__item__icon rounded-icon text-sky-600 bg-blue-100 ">
        <i class="${(t=this.category)==null?void 0:t.iconClasses}"></i>
      </div>
      <div class="flex-1 flex flex-col sm:flex-row justify-between sm:items-center">
        <div>
          <h4 class="font-bold">
            ${this.title}
          </h4>
          <div class="text-slate-500">
            ${this.date}
          </div>
        </div>
        <div class="font-bold mt-2 sm:mt-0">
          ${this.type==="credit"?"":"-"}$${this.amount}
        </div>
      </div>
      <div class="main-section__transactions__item__actions ml-6 flex items-center gap-4">
        <button class="main-section__transactions__item__actions__edit rounded-icon rounded-icon-clickable text-slate-600 bg-slate-100">
          <i class="fa fa-pencil"></i>
        </button>
        <button class="main-section__transactions__item__actions__delete rounded-icon rounded-icon-clickable text-red-600 bg-red-100">
          <i class="fa fa-trash"></i>
        </button>
      </div>
    </div>
  `}}const c={NEW:"new",EDIT:"edit"};class L{constructor({formSelector:t,transactionsSelector:e,walletsSelector:s}){n(this,"app");n(this,"transactionForm");n(this,"transactionsListEl");n(this,"walletsListEl");n(this,"entryCancelBtnEl");n(this,"transactionToEdit");n(this,"transactionFormMode",c.NEW);this.app=new T,this.transactionForm=document.querySelector(t),this.transactionsListEl=document.querySelector(e),this.walletsListEl=document.querySelector(s),this.entryCancelBtnEl=document.querySelector("#entryCancelBtn")}init(){this.initEventHandlers(),this.assignCategories(),this.renderWallets(this.app.wallets),this.renderTransactionsFromStorage()}renderTransactionsFromStorage(){this.app.transactionStorage.getAll().forEach(e=>{const s=this.createTransaction(e);this.app.transactions.push(s)})}renderWallet(t){const e=document.getElementById(t.id);e.querySelector(".sidebar__wallets__list__item__heading").textContent=t.title,e.querySelector(".sidebar__wallets__list__item__amount").textContent=`$${t.amount}`,t.isPrimary?e.classList.add("sidebar__wallets__list__item--active"):e.classList.remove("sidebar__wallets__list__item--active")}renderTransaction(t){const e=document.getElementById(`transaction_${t.id}`),s=t.getHtml();e.outerHTML=s}renderWallets(t){t.forEach(e=>{const s=e.getHtml();this.walletsListEl.appendChild(p(s))})}setFormMode(t){this.transactionFormMode=t;const{elements:e}=this.transactionForm,s=document.querySelector(".sidebar__heading");switch(this.transactionFormMode){case c.NEW:s.textContent="New Transaction",e.entrySubmitBtn.textContent="Create",this.entryCancelBtnEl.setAttribute("hidden","true"),this.transactionForm.reset(),this.transactionToEdit=null,this.transactionsListEl.querySelectorAll("button").forEach(a=>{a.removeAttribute("disabled")});break;case c.EDIT:s.textContent="Edit Transaction",e.entrySubmitBtn.textContent="Update",this.setTransactionFormValues(e,this.transactionToEdit),this.entryCancelBtnEl.removeAttribute("hidden"),this.transactionsListEl.querySelectorAll("button").forEach(a=>{a.setAttribute("disabled",!0)});break}}setTransactionFormValues(t,e){t.title.value=e.title,t.amount.value=e.amount,t.category.value=e.category.value,t.type.value=e.type}handleTransactionAction(t){const{target:e}=t,s=t.target.closest("[id^=transaction]"),a=s.id.replace("transaction_","");let i;e.nodeName==="button"?i=e:i=e.closest("button"),i.classList.contains("main-section__transactions__item__actions__delete")?(console.log("this is the delete button"),this.deleteTransaction(s,a)):i.classList.contains("main-section__transactions__item__actions__edit")&&(console.log("this is the edit button"),this.editTransaction(s,a))}editTransaction(t,e){const s=this.app.transactions.find(a=>a.id===e);this.transactionToEdit=s,this.setFormMode(c.EDIT)}assignCategories(){const t=document.querySelector(".sidebar__form #categoriesEl");this.app.categories.forEach(e=>{const s=document.createElement("OPTION");s.value=e.value,s.textContent=e.title,t.appendChild(s)})}initEventHandlers(){this.transactionForm.addEventListener("submit",t=>{t.preventDefault();const{elements:e}=t.target,s=e.title.value,a=e.amount.value,i=e.category.value,r=e.type.value,d=this.app.categories.find(l=>l.value===i);switch(this.transactionFormMode){case c.NEW:const l=this.createTransaction({title:s,amount:a,category:d,type:r});t.target.reset(),e.category.value=i,this.app.wallet.update({amount:r==="credit"?l.amount:-l.amount}),this.app.transactions.push(l);break;case c.EDIT:const h=this.transactionToEdit.amount-Number(a);this.transactionToEdit.update({title:s,amount:a,category:d,type:r}),this.app.wallet.update({amount:r==="debit"?h:-h}),this.renderTransaction(this.transactionToEdit),this.setFormMode(c.NEW);break}this.app.walletStorage.setAll(this.app.wallets),this.renderWallet(this.app.wallet),this.app.transactionStorage.setAll(this.app.transactions)}),this.walletsListEl.addEventListener("click",t=>{let e=t.target;e.nodeName!=="LI"&&(e=e.closest("LI")),t.stopImmediatePropagation(),this.app.wallet.update({isPrimary:!1}),this.renderWallet(this.app.wallet),this.changePrimaryWallet(e)}),this.transactionsListEl.addEventListener("click",this.handleTransactionAction.bind(this)),this.entryCancelBtnEl.addEventListener("click",()=>{this.setFormMode(c.NEW)})}deleteTransaction(t,e){const s=this.app.transactions.find(r=>r.id===e),{amount:a,type:i}=s;this.app.transactions=this.app.transactions.filter(r=>r.id!==s.id),this.app.transactionStorage.setAll(this.app.transactions),this.app.wallet.update({amount:i==="credit"?-a:a}),this.app.walletStorage.setAll(this.app.wallets),this.renderWallet(this.app.wallet),t.remove()}changePrimaryWallet(t){const e=this.app.wallets.find(s=>s.id===t.id);e.update({isPrimary:!0}),this.app.wallet=e,this.renderWallet(e)}createTransaction({title:t,amount:e,category:s,type:a}){const i=new C({title:t,amount:e,category:s,date:new Date,type:a}),r=i.getHtml();return this.transactionsListEl.appendChild(p(r)),i}}const A=()=>{new L({formSelector:".sidebar__form",transactionsSelector:".main-section__transactions",walletsSelector:".sidebar__wallets__list"}).init()};A();
